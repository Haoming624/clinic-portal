<!-- Delete Confirmation Modal -->
<div class="modal fade" id="confirmDeleteModal" tabindex="-1" aria-labelledby="confirmDeleteModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header bg-danger text-white">
        <h5 class="modal-title" id="confirmDeleteModalLabel">Confirm Deletion</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        Are you sure you want to delete <strong id="modalPatientName"></strong>?
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
        <%= button_to "#", method: :delete, class: "btn btn-danger", id: "confirmDeleteButton" do %>
          Yes
        <% end %>
      </div>
    </div>
  </div>
</div>

<script>
  document.addEventListener("turbo:load", () => {
    const deleteModal = document.getElementById("confirmDeleteModal");
    const patientNameEl = document.getElementById("modalPatientName");
    const deleteForm = document.getElementById("confirmDeleteButton")?.closest("form");

    if (!deleteModal || !patientNameEl || !deleteForm) return;

    deleteModal.addEventListener("show.bs.modal", event => {
      const button = event.relatedTarget;
      if (!button) return;

      const patientId = button.getAttribute("data-patient-id");
      const patientName = button.getAttribute("data-patient-name");

      patientNameEl.textContent = patientName || "";
      deleteForm.action = `/patients/${patientId}`;
    });
  });
</script>
